<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>게시판 목록</title>
    <link rel="stylesheet" th:href="@{/css/list.css}">
</head>
<body>

<!-- 상단 로고 & 로그인 정보 -->
<a href="/" class="nav-brand">내돈내삶</a>

<div class="nav-right">
    <div th:if="${session.loginUser != null}" class="nav-user-info">
        <span th:text="${session.loginUser.memberNickname + '님 환영합니다!'}"></span>
        &nbsp; | &nbsp;
        <a href="/logout" class="nav-logout-btn">로그아웃</a>
    </div>

    <div th:if="${session.loginUser == null}" class="nav-user-info">
        <a href="/login">로그인</a>
    </div>
</div>

<!-- 상단 배너 이미지 -->
<img th:src="@{/img/게시판 이미지.jpg}"
     alt="게시판 이미지"
     style="width:100%; max-height:150px; object-fit:cover; margin-bottom:20px; border-radius: 5px">

<h2>가계부 게시판 목록</h2>

<!-- 글쓰기 버튼 (로그인만 가능) -->
<th:block th:if="${session.loginUser != null}">
    <a class="write-btn" href="/board/write">글쓰기</a>
</th:block>

<!-- 비로그인 상태 → 안내 버튼 -->
<th:block th:if="${session.loginUser == null}">
    <button class="write-btn"
            style="background:#ccc; cursor:pointer;"
            onclick="alert('로그인 후 이용 가능합니다.');">
        글쓰기
    </button>
</th:block>

<br/><br/>

<!-- 게시글 목록 -->
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>카테고리</th>
        <th>제목</th>
        <th>작성자</th>
        <th>작성일</th>
        <th>조회수</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="p : ${posts}">
        <td th:text="${p.id}"></td>
        <td th:text="${p.category}"></td>

        <td>
            <a th:href="@{'/board/' + ${p.id}}"
               th:text="${p.postTitle}"></a>
        </td>

        <td th:text="${p.writer != null ? p.writer.memberNickname : '작성자 없음'}"></td>

        <td th:text="${#temporals.format(p.createdAt,'yyyy-MM-dd HH:mm')}"></td>

        <td th:text="${p.viewCnt}"></td>
    </tr>
    </tbody>
</table>

<br><br>

<!-- 검색창 -->
<form class="board-search-box"
      th:action="@{/board}" method="get">

    <input type="text" name="keyword"
           th:value="${keyword}"
           placeholder="검색어를 입력하세요 (제목+내용)">

    <button type="submit">검색</button>
</form>

<br/>

<!-- 페이징 -->
<!-- ===========================
           페이징 (≪ 1 2 3 ≫)
============================= -->
<div th:with="page=${posts.number}, last=${posts.totalPages}, size=${posts.size}"
     class="my-4 d-flex justify-content-center">

    <nav>
        <ul class="pagination">

            <!-- 맨 처음 페이지로 (≪) -->
            <li class="page-item"
                th:classappend="${page == 0} ? ' disabled'">
                <a class="page-link"
                   th:href="@{/board(page=0, size=${size}, keyword=${keyword})}">
                    ≪
                </a>
            </li>

            <!-- 페이지 번호 목록 -->
            <li class="page-item"
                th:each="i : ${#numbers.sequence(1, last)}"
                th:classappend="${(i - 1) == page} ? ' active'">
                <a class="page-link"
                   th:href="@{/board(page=${i - 1}, size=${size}, keyword=${keyword})}"
                   th:text="${i}">
                </a>
            </li>

            <!-- 맨 마지막 페이지로 (≫) -->
            <li class="page-item"
                th:classappend="${page == (last - 1)} ? ' disabled'">
                <a class="page-link"
                   th:href="@{/board(page=${last - 1}, size=${size}, keyword=${keyword})}">
                    ≫
                </a>
            </li>

        </ul>
    </nav>
</div>


</body>
</html>
