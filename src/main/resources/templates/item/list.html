<!doctype html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_layout}">

<head>
    <!--    ë³‘í•© - ì£¼ì„ì²˜ë¦¬ --> <!--ë¶ˆí•„ìš”ì‹œ ì‚­ì œ -->
<!--
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Hotdeal</title>

    &lt;!&ndash; Bootstrap CDN &ndash;&gt;
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

    &lt;!&ndash; í”„ë¡œì íŠ¸ ë‚´ë¶€ CSS &ndash;&gt;
    <link th:href="@{/css/list.css}" rel="stylesheet"/>

    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&display=swap" rel="stylesheet">
-->

    <style layout:fragment="css">
        .menu-link:hover {
            color: black;
            text-decoration: underline;
        }
    </style>

</head>
<body>

<div layout:fragment="content">
<!--    ê¸°ì¡´ main -->
    <!-- ë§ˆì´í˜ì´ì§€ ë²„íŠ¼ -->

    <!--<div class="d-flex flex-wrap align-items-center gap-2 justify-content-end">
        <a th:href="@{/mypage}" class="btn btn-outline-secondary btn-sm" role="button" aria-label="ë§ˆì´í˜ì´ì§€">
                &lt;!&ndash;â”” ë§í¬ìˆ˜ì •í•„ìš” &ndash;&gt;
            ë§ˆì´í˜ì´ì§€
        </a>
    </div>-->

<!-- Feature Cards -->
<!--<div class="container py-5">
    <div class="row g-2 text-center">

        <div class="col-md-4">
            <a href="/board" class="text-decoration-none fs-6 fw-bold d-block py-2 menu-link">
                ê²Œì‹œíŒ
            </a>
        </div>
        <div class="col-md-4">
            <a href="/ledger" class="text-decoration-none fs-6 fw-bold d-block py-2 menu-link">
                ê°€ê³„ë¶€
            </a>
        </div>
        <div class="col-md-4">
            <a href="/hotdeal" class="text-decoration-none fs-5 fw-bold d-block py-2 menu-link active">
                í•«ë”œ
            </a>
        </div>
    </div>
</div>-->

<!--    main ë‚´ìš©, ë¡œê·¸ì¸ê´€ë ¨ìœ¼ë¡œ ìœ ì¶”ì¤‘ -->
<!--     ğŸ”¹ íŒë§¤ì ë“±ë¡ / íŒë§¤ì ìƒì„¸ / ë¡œê·¸ì¸ í›„ ìœ ë„ ë²„íŠ¼-->
    <div class="d-flex justify-content-end mb-3">

        <!-- 1) ë¹„ë¡œê·¸ì¸: ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ìœ ë„ -->
        <a th:if="${session.loginUser == null}"
           th:href="@{/login}"
           class="btn btn-outline-secondary btn-sm">
            ë¡œê·¸ì¸ í›„ íŒë§¤ì ë“±ë¡
        </a>

        <!-- 2) ë¡œê·¸ì¸ í–ˆê³ , ì•„ì§ íŒë§¤ìê°€ ì•„ë‹Œ ê²½ìš°: íŒë§¤ì ë“±ë¡ (í™œì„±) -->
        <a th:if="${session.loginUser != null and (session.isSeller == null or session.isSeller == false)}"
           th:href="@{/seller/join}"
           class="btn btn-outline-primary btn-sm">
            íŒë§¤ì ë“±ë¡
        </a>

        <!-- 3) ë¡œê·¸ì¸ í–ˆê³ , ì´ë¯¸ íŒë§¤ìì¸ ê²½ìš°: íŒë§¤ì ë“±ë¡ ë²„íŠ¼ ë¹„í™œì„± -->
        <a th:if="${session.loginUser != null and session.isSeller == true}"
           th:href="@{/seller}"
           class="btn btn-outline-primary btn-sm"
           style="opacity:0; pointer-events:none;">
            íŒë§¤ì ìƒì„¸
        </a>
    </div>

    <!--    ë³‘í•© - hotdeal ë‚´ìš©ìœ¼ë¡œ  -->
    <!--    ì¹´í…Œê³ ë¦¬ ë²„íŠ¼-->
    <form th:action="@{/hotdeal/search}" method="get" class="d-flex mb-4">

        <!--             ìˆ¨ê²¨ì§„ í•„ë“œ/â‡’ í˜„ì¬ ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ê°’ ìœ ì§€ -->
        <input type="hidden" name="categoryId" th:value="${param.categoryId}" />

        <!-- ì¹´í…Œê³ ë¦¬ ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ -->
        <div class="category-wrap-overlay position-relative d-flex align-items-center" style="flex:1;">
            <!-- ê·¸ë¼ë°ì´ì…˜ ì˜¤ë²„ë ˆì´ (ì™¼ìª½) -->
            <div class="fade-overlay fade-left" aria-hidden="true"></div>

            <!--             ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ê·¸ë£¹ -->
            <!--            <div class="btn-group me-2" role="group">-->
            <div class="category-scroll" id="categoryScroll" role="tablist" aria-label="ì¹´í…Œê³ ë¦¬">
                <!--                ì „ì²´ë²„íŠ¼-->
                <a th:href="@{/hotdeal}"
                   th:classappend="${param.categoryId == null or param.categoryId[0] == ''} ? 'btn-primary' : 'btn-outline-secondary'"
                   class="btn btn-outline-secondary btn-sm mx-1">ì „ì²´</a>

                <!--             DBì—ì„œ ê°€ì ¸ì˜¨ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ë“¤ -->
                <!-- th:href="@{'/hotdeal'(categoryId=${c.categoryId}, q=${param.q})} â‡’ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¡œ í•„í„° + ê²€ìƒ‰ì–´ ìœ ì§€-->
                <a th:each="c : ${categories}"
                   th:href="@{'/hotdeal'(categoryId=${c.categoryId}, q=${param.q})}"
                   th:text="${c.categoryName}"
                   th:classappend="${param.categoryId != null and param.categoryId[0]  == c.categoryId} ? 'btn-primary' : 'btn-outline-secondary'"
                   class="btn btn-outline-secondary btn-sm category-btn mx-1">
                </a>
            </div>


            <!-- ê·¸ë¼ë°ì´ì…˜ ì˜¤ë²„ë ˆì´ (ì˜¤ë¥¸ìª½) -->
            <div class="fade-overlay fade-right" aria-hidden="true"></div>

            <!-- ì™¼ìª½/ì˜¤ë¥¸ìª½ í™”ì‚´í‘œ (SVG ì•„ì´ì½˜) -->
            <button type="button" class="cat-scroll-btn btn btn-light" id="catScrollLeft" aria-label="ì™¼ìª½ìœ¼ë¡œ ìŠ¤í¬ë¡¤" disabled>
                <!-- left SVG -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>

            <button type="button" class="cat-scroll-btn btn btn-light" id="catScrollRight" aria-label="ì˜¤ë¥¸ìª½ìœ¼ë¡œ ìŠ¤í¬ë¡¤">
                <!-- right SVG -->
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>

        </div>

        <!--        ê²€ìƒ‰ì°½-->
        <input type="text" name="q"
               th:value="${param.q}"
               class="form-control form-control-sm ms-2 search-input"
               placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
        />
        <button type="submit" class="btn btn-primary">ê²€ìƒ‰</button>
    </form>


    <!-- ì •ë ¬(ë“œë¡­ë‹¤ìš´) -->
<!-- ì„œë²„ë¡œëŠ” ?sort=NEWEST, PRICE_ASC, PRICE_DESC, POPULAR ë“±ìœ¼ë¡œ ì „ë‹¬ -->
<div class="dropdown d-flex justify-content-end">
    <button class="btn btn-light btn-sm dropdown-toggle" type="button" id="sortDropdown"
            data-bs-toggle="dropdown" aria-expanded="false">
        ì •ë ¬: <span th:text="${currentSortLabel != null ? currentSortLabel : 'ìµœì‹ ìˆœ'}">ìµœì‹ ìˆœ</span>
    </button>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="sortDropdown">
        <li><a class="dropdown-item" th:href="@{'?'(page=0,sort='createdAt,desc')}">ìµœì‹ ìˆœ</a></li>
        <li><a class="dropdown-item" th:href="@{'?'(page=0,sort='itemSaleprice,asc')}">ë‚®ì€ ê°€ê²©</a></li>
        <li><a class="dropdown-item" th:href="@{'?'(page=0,sort='itemSaleprice,desc')}">ë†’ì€ ê°€ê²©</a></li>
        <!-- ìˆ˜ì •í•„ìš”                <li><a class="dropdown-item" th:href="@{'?'(page=0,sort='createdAt,desc')}">ì¸ê¸°ë„</a></li>-->
    </ul>
</div>


    <!--        ë“±ë¡ëœ ìƒí’ˆ ì „ì²´ ê°¯ìˆ˜ ì‘ì€ê¸€ì”¨ë¡œ ë³´ì—¬ì£¼ê¸°-->
    <!--<div class="container py-4">-->
    <div  class="d-flex justify-content-end py-2">
        <small th:text="'ì´ ' + ${itemPage.totalElements} + 'ê°œ'">ì´ 0ê°œ</small>
    </div>
    <!--</div>-->

<!--<div class="container py-4"> // ì´ì „ë‚´ìš© -->
<!--&lt;!&ndash;    <div class="d-flex justify-content-between align-items-center mb-3">&ndash;&gt;-->
<!--&lt;!&ndash;        <h1 class="h3">Hotdeal</h1>&ndash;&gt;-->
<!--        <div  class="d-flex justify-content-end">-->
<!--            <small th:text="'ì´ ' + ${itemPage.totalElements} + 'ê°œ'">ì´ 0ê°œ</small>-->
<!--        </div>-->
<!--    </div>-->

    <!-- ìƒí’ˆ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ -->

    <div class="row g-3">
        <div class="col-12 col-sm-6 col-md-4 col-lg-3" th:each="item : ${itemPage.content}">
            <div class="card h-100">
                <a th:href="@{/hotdeal/{id}(id=${item.id})}" style="text-decoration:none;color:inherit;">
<!--                      or hotdeal -->
                    <!-- ì´ë¯¸ì§€ -->
                    <img th:src="${item.itemImageUrl != null ? item.itemImageUrl : '/img/no-image.png'}"
                         class="card-img-top"
                         alt="thumb"
                         onerror="this.src='/img/no-image.png'"/>
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title" th:text="${item.itemName}">ìƒí’ˆëª…</h5>
                        <p class="card-text mt-auto">
<!--                            <strong th:text="${#numbers.formatDecimal(item.itemSaleprice, 0, 'COMMA', 2, 'POINT')} + 'ì›'">0ì›</strong>-->
                            <strong th:text="${item.formattedPrice}">0ì›</strong>
                        </p>
                        <div class="text-muted small">
                            ì¡°íšŒìˆ˜: <span th:text="${item.viewCount}">0</span>
                            &nbsp;Â·&nbsp; ì¸ê¸°ë„: <span th:text="${item.popularityScore}">0</span>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>


<!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
<div th:with="page=${itemPage.number}, last=${itemPage.totalPages}, sort=${itemPage.sort}, size=${param.size}" class="my-4 d-flex justify-content-center">
    <nav>
        <ul class="pagination">
            <li class="page-item" th:classappend="(${itemPage}==0 ? 'disabled')">
                <a class="page-link" th:href="@{'?'(page=0, size=${size})}">â‰ª</a>
            </li>
            <li class="page-item" th:each="i : ${#numbers.sequence(1, last)}"
                th:classappend="((${i}-1) == ${page}?'active')">
                <a class="page-link" th:href="@{'?'(page=${i}-1, size=${size})}" th:text="${i}"></a>
            </li>
            <li class="page-item" th:classappend="(${page} == (${last}-1) ? 'disabled')">
                <a class="page-link" th:href="@{'?'(page=${last}-1, size=${size})}">â‰«</a>
            </li>
        </ul>
    </nav>
</div>

</div>
<script layout:fragment="script">
    //alert("script"); // ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸ í•„ìš” ì‹œ ì—¬ê¸° ì‘ì„±
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>