<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_layout}"
      th:with="CONTENT_TITLE='íšŒì› ê´€ë¦¬ | ë‚´ëˆë‚´ì‚¶'">

<head>
    <meta charset="UTF-8">
    <style layout:fragment="css">
        .admin-page-wrapper {
            margin-top: 30px;
            margin-bottom: 40px;
        }

        .admin-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-end;
            gap: 12px;
            margin-bottom: 10px;
        }

        .admin-title-box {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .admin-table-title {
            font-size: 24px;
            font-weight: 700;
            margin: 0;
        }

        .admin-subtext {
            margin: 0;
            color: #6c757d;
            font-size: 14px;
        }

        .admin-legend {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            font-size: 12px;
            color: #6c757d;
        }

        .admin-legend span::before {
            content: "â€¢ ";
        }

        .admin-card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.05);
            border: 1px solid #f1f3f5;
            padding: 16px 18px 14px;
        }

        .admin-table-wrapper {
            margin-top: 10px;
        }

        .badge-enabled {
            padding: 2px 8px;
            border-radius: 999px;
            background: #e3f2fd;
            color: #0d47a1;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-disabled {
            padding: 2px 8px;
            border-radius: 999px;
            background: #ffebee;
            color: #b71c1c;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-role {
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 12px;
            font-weight: 500;
            background: #f1f3f5;
            color: #495057;
        }

        .badge-role-admin {
            background: #6c63ff11;
            color: #6c63ff;
        }

        .badge-role-seller {
            background: #e8fff5;
            color: #087f5b;
        }

        .badge-role-user {
            background: #f1f3ff;
            color: #364fc7;
        }

        /* ğŸ”¹ ì•„ì´ë”” ì¹¼ëŸ¼ í­ ì œí•œ + ë§ì¤„ì„í‘œ */
        .col-member-id {
            max-width: 140px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .admin-action-btn {
            min-width: 74px;
        }

        .admin-pagination-wrapper {
            margin-top: 16px;
        }
    </style>
</head>

<body>
<main layout:fragment="content" class="container" style="min-height: 70vh;">

    <div class="admin-page-wrapper">

        <!-- ìƒë‹¨ í—¤ë” -->
        <div class="admin-header">
            <div class="admin-title-box">
                <h1 class="admin-table-title">íšŒì› ê´€ë¦¬</h1>
                <p class="admin-subtext">
                    ì‚¬ì´íŠ¸ì— ê°€ì…í•œ ì „ì²´ íšŒì› ëª©ë¡ê³¼ ìƒíƒœë¥¼ í™•ì¸Â·ê´€ë¦¬í•©ë‹ˆë‹¤.
                </p>
            </div>

            <div class="admin-legend">
                <span>ì•„ì´ë”” / ì´ë¦„ / ë‹‰ë„¤ì„ìœ¼ë¡œ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
                <span>ì•„ì´ë””ê°€ ê¸¸ë©´ ë§ì¤„ì„í‘œ(â€¦)ë¡œ í‘œì‹œë˜ë©°, ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ì „ì²´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
            </div>
        </div>

        <!-- ğŸ” ê²€ìƒ‰ í¼ -->
        <form class="row g-2 mb-3" th:action="@{/admin/members}" method="get">
            <div class="col-sm-4 col-8">
                <input type="text"
                       name="keyword"
                       class="form-control form-control-sm"
                       placeholder="ì•„ì´ë”” / ì´ë¦„ / ë‹‰ë„¤ì„ ê²€ìƒ‰"
                       th:value="${keyword}">
            </div>
            <div class="col-auto">
                <button class="btn btn-sm btn-primary" type="submit">ê²€ìƒ‰</button>
            </div>
            <div class="col-auto" th:if="${keyword != null and !#strings.isEmpty(keyword)}">
                <a class="btn btn-sm btn-outline-secondary" th:href="@{/admin/members}">ì´ˆê¸°í™”</a>
            </div>
        </form>

        <!-- ì¹´ë“œ ë°•ìŠ¤ + í…Œì´ë¸” -->
        <div class="admin-card">
            <div class="admin-table-wrapper table-responsive">
                <table class="table table-sm table-hover align-middle mb-2">
                    <thead class="table-light">
                    <tr>
                        <th style="width: 16%;">ì•„ì´ë””</th>
                        <th style="width: 14%;">ì´ë¦„</th>
                        <th style="width: 16%;">ë‹‰ë„¤ì„</th>
                        <th style="width: 14%;">ê¶Œí•œ(ROLE)</th>
                        <th style="width: 12%;">ìƒíƒœ</th>
                        <th style="width: 18%;">ê°€ì…ì¼</th>
                        <th style="width: 10%;">ìƒíƒœ ë³€ê²½</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- âœ… Page<Member> ê¸°ì¤€ìœ¼ë¡œ content ì‚¬ìš© -->
                    <tr th:each="m : ${memberPage.content}">
                        <td class="col-member-id">
                            <span th:text="${m.memberId}"
                                  th:title="${m.memberId}">user01</span>
                        </td>
                        <td th:text="${m.memberName}">í™ê¸¸ë™</td>
                        <td th:text="${m.memberNickname}">ê¸¸ë™ì´</td>
                        <td>
                            <span class="badge-role"
                                  th:classappend="
                                        ${#strings.startsWith(m.role, 'ROLE_ADMIN')} ? ' badge-role-admin' :
                                        (${#strings.startsWith(m.role, 'ROLE_SELLER')} ? ' badge-role-seller' :
                                        ' badge-role-user')"
                                  th:text="${m.role}">
                                USER
                            </span>
                        </td>
                        <td>
                            <span th:if="${m.enabled == 'Y'}" class="badge-enabled">í™œì„±</span>
                            <span th:if="${m.enabled != 'Y'}" class="badge-disabled">ë¹„í™œì„±/íƒˆí‡´</span>
                        </td>
                        <td th:text="${#temporals.format(m.createdAt, 'yyyy-MM-dd HH:mm')}">2025-01-01</td>

                        <!-- âœ… í™œì„±/ë¹„í™œì„± í† ê¸€ ë²„íŠ¼ -->
                        <td>
                            <form th:action="@{'/admin/members/' + ${m.memberId} + '/toggle'}"
                                  method="post"
                                  class="d-inline">

                                <!-- í˜„ì¬ í˜ì´ì§€ ìœ ì§€ -->
                                <input type="hidden" name="page" th:value="${memberPage.number}"/>
                                <input type="hidden" name="size" th:value="${memberPage.size}"/>

                                <!-- ê²€ìƒ‰ì–´ ìœ ì§€ (ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì•ˆ ë°›ì•„ë„ ì—ëŸ¬ëŠ” ì•ˆ ë‚¨) -->
                                <input type="hidden" name="keyword" th:value="${keyword}"/>

                                <button type="submit"
                                        th:if="${m.enabled == 'Y'}"
                                        class="btn btn-sm btn-outline-danger admin-action-btn">
                                    ë¹„í™œì„±í™”
                                </button>

                                <button type="submit"
                                        th:if="${m.enabled != 'Y'}"
                                        class="btn btn-sm btn-outline-success admin-action-btn">
                                    í™œì„±í™”
                                </button>
                            </form>
                        </td>
                    </tr>

                    <!-- ë°ì´í„° ì—†ì„ ë•Œ -->
                    <tr th:if="${#lists.isEmpty(memberPage.content)}">
                        <td colspan="7" class="text-center text-muted py-4">
                            ì¡°ê±´ì— ë§ëŠ” íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>

                    </tbody>
                </table>
            </div>

            <!-- âœ… í˜ì´ì§€ë„¤ì´ì…˜ -->
            <div class="d-flex justify-content-center admin-pagination-wrapper"
                 th:if="${memberPage.totalPages > 1}">
                <ul class="pagination pagination-sm mb-0">

                    <!-- ì²˜ìŒ í˜ì´ì§€ -->
                    <li class="page-item" th:classappend="${memberPage.first} ? 'disabled'">
                        <a class="page-link"
                           th:href="@{'/admin/members'(page=0, size=${memberPage.size}, keyword=${keyword})}">
                            â‰ª
                        </a>
                    </li>

                    <!-- ì´ì „ í˜ì´ì§€ -->
                    <li class="page-item" th:classappend="${memberPage.first} ? 'disabled'">
                        <a class="page-link"
                           th:href="@{'/admin/members'(page=${memberPage.number - 1}, size=${memberPage.size}, keyword=${keyword})}">
                            â€¹
                        </a>
                    </li>

                    <!-- í˜ì´ì§€ ë²ˆí˜¸ë“¤ -->
                    <li class="page-item"
                        th:each="p : ${#numbers.sequence(0, memberPage.totalPages - 1)}"
                        th:classappend="${p == memberPage.number} ? 'active'">
                        <a class="page-link"
                           th:href="@{'/admin/members'(page=${p}, size=${memberPage.size}, keyword=${keyword})}"
                           th:text="${p + 1}">
                            1
                        </a>
                    </li>

                    <!-- ë‹¤ìŒ í˜ì´ì§€ -->
                    <li class="page-item" th:classappend="${memberPage.last} ? 'disabled'">
                        <a class="page-link"
                           th:href="@{'/admin/members'(page=${memberPage.number + 1}, size=${memberPage.size}, keyword=${keyword})}">
                            â€º
                        </a>
                    </li>

                    <!-- ë§ˆì§€ë§‰ í˜ì´ì§€ -->
                    <li class="page-item" th:classappend="${memberPage.last} ? 'disabled'">
                        <a class="page-link"
                           th:href="@{'/admin/members'(page=${memberPage.totalPages - 1}, size=${memberPage.size}, keyword=${keyword})}">
                            â‰«
                        </a>
                    </li>

                </ul>
            </div>
        </div>

    </div>

</main>
</body>
</html>
